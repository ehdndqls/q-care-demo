<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up - Q-Care</title>
    <link rel="stylesheet" href="css/join.css">
</head>
<body>
<div class="container">
    <div class="header">
        <div class="logo">
            <span class="logo-text">Q-Care</span>
        </div>
    </div>

    <div class="main-content">
        <h1 class="title">Create Account</h1>
        <p class="subtitle">Join Q-Care for better healthcare access</p>

        <form id="signupForm" class="signup-form">
            <div class="form-section">
                <h3 class="section-title">Personal Information</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstName">First Name</label>
                        <input type="text" id="firstName" name="firstName" required>
                    </div>
                    <div class="form-group">
                        <label for="lastName">Last Name</label>
                        <input type="text" id="lastName" name="lastName" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" required>
                </div>

                <div class="form-group">
                    <label for="phoneNum">Phone Number</label>
                    <input type="tel" id="phoneNum" name="phoneNum" required>
                </div>

                <div class="form-group">
                    <label for="brithDate">Date of Birth</label>
                    <input type="date" id="brithDate" name="brithDate" required>
                </div>

                <div class="form-group">
                    <label for="language">Preferred Language</label>
                    <select id="language" name="language" required>
                        <option value="">Select Language</option>
                        <option value="KOREAN">한국어</option>
                        <option value="ENGLISH">English</option>
                        <option value="JAPANESE">日本語</option>
                        <option value="CHINESE">中文</option>
                    </select>
                </div>
            </div>

            <div class="form-section">
                <h3 class="section-title">Security</h3>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required minlength="8">
                </div>

                <div class="form-group">
                    <label for="confirmPassword">Confirm Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" required minlength="8">
                </div>
            </div>

            <div class="form-group checkbox-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="terms" required>
                    <span class="checkmark"></span>
                    <span class="terms-text">I agree to the Terms of Service and Privacy Policy</span>
                </label>
            </div>

            <button type="submit" class="submit-btn">Create Account</button>

            <div class="login-link">
                <span class="login-text">Already have an account? </span>
                <a href="login.html" class="link login-a">Sign In</a>
            </div>
        </form>
    </div>
</div>

<script>
    const translations = {
        KOREAN: {
            title: "계정 만들기",
            subtitle: "Q-Care에 가입하여 더 나은 의료 서비스를 이용하세요",
            firstName: "성",
            lastName: "이름",
            email: "이메일 주소",
            phoneNum: "전화번호",
            brithDate: "생년월일",
            password: "비밀번호",
            confirmPassword: "비밀번호 확인",
            submitBtn: "계정 생성",
            terms: "서비스 약관 및 개인정보 처리방침에 동의합니다",
            loginLinkText: "이미 계정이 있으신가요? ",
            loginLinkA: "로그인",
            loginLinkHref: "login.html"
        },
        ENGLISH: {
            title: "Create Account",
            subtitle: "Join Q-Care for better healthcare access",
            firstName: "First Name",
            lastName: "Last Name",
            email: "Email Address",
            phoneNum: "Phone Number",
            brithDate: "Date of Birth",
            password: "Password",
            confirmPassword: "Confirm Password",
            submitBtn: "Create Account",
            terms: "I agree to the Terms of Service and Privacy Policy",
            loginLinkText: "Already have an account? ",
            loginLinkA: "Sign In",
            loginLinkHref: "login.html"
        },
        JAPANESE: {
            title: "アカウント作成",
            subtitle: "Q-Careに登録して、より良い医療サービスを利用しましょう",
            firstName: "名",
            lastName: "姓",
            email: "メールアドレス",
            phoneNum: "電話番号",
            brithDate: "生年月日",
            password: "パスワード",
            confirmPassword: "パスワード確認",
            submitBtn: "アカウント作成",
            terms: "利用規約とプライバシーポリシーに同意します",
            loginLinkText: "すでにアカウントをお持ちですか？",
            loginLinkA: "ログイン",
            loginLinkHref: "login.html"
        },
        CHINESE: {
            title: "创建账户",
            subtitle: "加入 Q-Care，获取更好的医疗服务",
            firstName: "名字",
            lastName: "姓氏",
            email: "电子邮件地址",
            phoneNum: "电话号码",
            brithDate: "出生日期",
            password: "密码",
            confirmPassword: "确认密码",
            submitBtn: "创建账户",
            terms: "我同意服务条款和隐私政策",
            loginLinkText: "已经有账户？",
            loginLinkA: "登录",
            loginLinkHref: "login.html"
        }
    };

    // URL에서 lang 가져오기
    const params = new URLSearchParams(window.location.search);
    const lang = params.get('lang') || 'ENGLISH';

    function applyLanguage(lang) {
        if (!translations[lang]) return;
        const t = translations[lang];

        document.querySelector('.title').textContent = t.title;
        document.querySelector('.subtitle').textContent = t.subtitle;
        document.querySelector('label[for="firstName"]').textContent = t.firstName;
        document.querySelector('label[for="lastName"]').textContent = t.lastName;
        document.querySelector('label[for="email"]').textContent = t.email;
        document.querySelector('label[for="phoneNum"]').textContent = t.phoneNum;
        document.querySelector('label[for="brithDate"]').textContent = t.brithDate;
        document.querySelector('label[for="password"]').textContent = t.password;
        document.querySelector('label[for="confirmPassword"]').textContent = t.confirmPassword;
        document.querySelector('.submit-btn').textContent = t.submitBtn;
        document.querySelector('.terms-text').textContent = t.terms;

        // 로그인 링크
        document.querySelector('.login-text').textContent = t.loginLinkText;
        const loginA = document.querySelector('.login-a');
        loginA.textContent = t.loginLinkA;
        loginA.href = t.loginLinkHref;

        // select 박스 초기화
        document.getElementById('language').value = lang;
    }

    applyLanguage(lang);

    document.getElementById('signupForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        const formData = new FormData(this);
        const data = Object.fromEntries(formData);

        if (data.password !== data.confirmPassword) {
            alert('Passwords do not match!');
            return;
        }

        data.latitude = 37.5665;
        data.longitude = 126.9780;

        try {
            const response = await fetch('/request-join', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            if (response.ok) {
                alert('Account created successfully!');
                window.location.href = 'login.html';
            } else {
                const error = await response.json();
                alert(error.errorMessage || 'Registration failed');
            }
        } catch (error) {
            alert('Network error. Please try again.');
        }
    });
</script>
</body>
</html>
